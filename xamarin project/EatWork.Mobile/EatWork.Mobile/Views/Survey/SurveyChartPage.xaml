<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:utils="clr-namespace:EatWork.Mobile.Utils"
             xmlns:local="clr-namespace:EatWork.Mobile.Views.Shared"
             xmlns:busyindicator="clr-namespace:Syncfusion.SfBusyIndicator.XForms;assembly=Syncfusion.SfBusyIndicator.XForms"
             xmlns:chart="clr-namespace:Syncfusion.SfChart.XForms;assembly=Syncfusion.SfChart.XForms"
             xmlns:button="clr-namespace:Syncfusion.XForms.Buttons;assembly=Syncfusion.Buttons.XForms"
             xmlns:expander="clr-namespace:Syncfusion.XForms.Expander;assembly=Syncfusion.Expander.XForms"
             x:Class="EatWork.Mobile.Views.Survey.SurveyChartPage"
             Style="{StaticResource ContentPage}">

    <ContentPage.Resources>
        <ResourceDictionary>
            <DataTemplate x:Key="toolTipTemplate1">
                <StackLayout BackgroundColor="#404041">
                    <StackLayout.Padding>
                        <OnPlatform x:TypeArguments="Thickness" WinPhone="3,3,3,3" />
                    </StackLayout.Padding>
                    <Label Text="Imports" HorizontalTextAlignment="Center" VerticalTextAlignment="Center" TextColor="White" FontAttributes="Bold" FontFamily="Helvetica" Margin="{OnPlatform Default='0', WPF='0,4,0,0', macOS='0,4,0,0'}" FontSize="12" Grid.Row="0" />
                    <BoxView Color="White" HeightRequest="0.75" VerticalOptions="FillAndExpand" Margin="{OnPlatform Default='0', WPF='4,0,4,0', macOS='4,0,4,0'}" HorizontalOptions="FillAndExpand" />
                    <StackLayout Orientation="Horizontal"  VerticalOptions="FillAndExpand" BackgroundColor="#404041" Spacing="0" Padding="{OnPlatform Default='3', macOS='0,0,0,3'}" Margin="0">
                        <Label Text="{Binding Name}" VerticalTextAlignment="Center" HorizontalOptions="StartAndExpand" TextColor="#CCCCCC" FontAttributes="Bold" FontFamily="Helvetica" FontSize="12" Margin="{OnPlatform Default='0', WPF='3,0,0,0', macOS='3,0,0,0'}" />
                        <Label Text="{Binding Value,StringFormat=' :  {0}B'}" VerticalTextAlignment="Center" HorizontalOptions="EndAndExpand" TextColor="White" FontAttributes="Bold" FontFamily="Helvetica" Margin="{OnPlatform Default='0', WPF='0,0,3,0', macOS='0,0,3,0'}" FontSize="12" />
                    </StackLayout>
                </StackLayout>
            </DataTemplate>
        </ResourceDictionary>
    </ContentPage.Resources>

    <ContentPage.Content>
        <AbsoluteLayout VerticalOptions="FillAndExpand" HorizontalOptions="FillAndExpand">
            <busyindicator:SfBusyIndicator x:Name="busyindicator"
                                           Style="{StaticResource BusyIndicatorStyle}"
                                           IsBusy="{Binding IsBusy}" />

            <StackLayout AbsoluteLayout.LayoutFlags="PositionProportional"
                         AbsoluteLayout.LayoutBounds="0.5,0.5,-1,-1"
                         IsVisible="{Binding IsBusy,Converter={utils:InverseBoolConverter}}"
                         HorizontalOptions="CenterAndExpand"
                         VerticalOptions="CenterAndExpand">

                <local:NoItemsPartialPage DetailsText="No items available to display."
                                          HorizontalOptions="CenterAndExpand"
                                          VerticalOptions="CenterAndExpand"
                                          Margin="0,0"
                                          IsVisible="{Binding ShowPage,Converter={utils:InverseBoolConverter}}" />
            </StackLayout>

            <Grid RowSpacing="0" ColumnSpacing="0"
                  AbsoluteLayout.LayoutFlags="All"
                  AbsoluteLayout.LayoutBounds="0,0,1,1"
                  RowDefinitions="*">
                <StackLayout Grid.Row="0" Margin="10,10" Spacing="0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="80" />
                        </Grid.ColumnDefinitions>

                        <Label Text="Survey Chart" HorizontalOptions="Start"
                               FontSize="20"
                               FontFamily="{DynamicResource Bold}"
                               TextColor="{DynamicResource Gray-900}"
                               Grid.Column="0" />

                        <button:SfButton x:Name="SkipButton"
                                         Grid.Column="1"
                                         BackgroundColor="Transparent"
                                         Command="{Binding CloseModalCommand}"
                                         CornerRadius="20"
                                         FontFamily="{DynamicResource SemiBold}"
                                         HeightRequest="40"
                                         HorizontalOptions="End"
                                         Text="Close"
                                         TextColor="{x:StaticResource HyperLink}"
                                         VerticalOptions="StartAndExpand"
                                         WidthRequest="80" />
                    </Grid>

                    <Grid RowSpacing="0" ColumnSpacing="0" Margin="0,20,0,0"
                          IsVisible="{Binding IsBusy,Converter={utils:InverseBoolConverter}}">
                        <ScrollView>
                            <StackLayout Margin="0"
                                         Spacing="16"
                                         VerticalOptions="FillAndExpand"
                                         IsVisible="{Binding ShowPage}">

                                <StackLayout Spacing="16"
                                             VerticalOptions="FillAndExpand"
                                             x:Name="stackLayout">

                                    <utils:CustomShadowFrame Margin="4"
                                                             Padding="0"
                                                             BackgroundColor="{DynamicResource GrayShadowColor}"
                                                             BorderColor="{DynamicResource GrayShadowColor}"
                                                             BorderWidth="2"
                                                             CornerRadius="4"
                                                             HasShadow="True"
                                                             Radius="4">

                                        <expander:SfExpander  x:Name="expander"
                                                              AnimationDuration="350"
                                                              AnimationEasing="Linear"
                                                              HeaderBackgroundColor="Transparent"
                                                              HeaderIconPosition="None"
                                                              IsExpanded="True">
                                            <expander:SfExpander.Header>
                                                <Grid Margin="2"
                                                      Padding="16"
                                                      RowDefinitions="Auto, Auto">

                                                    <!--<Label x:Name="categoryLabel"
                                                         FontFamily="{DynamicResource Bold}"
                                                         FontSize="14"
                                                         HorizontalOptions="Start"
                                                         HorizontalTextAlignment="Center"
                                                         LineHeight="1.25"
                                                         Text="NSEI"
                                                         TextColor="{DynamicResource Gray-900}"
                                                         VerticalTextAlignment="Center" />
                                                         
                                                         <Label Grid.Column="1"
                                                         FontFamily="{DynamicResource SemiBold}"
                                                         FontSize="16"
                                                         HorizontalOptions="EndAndExpand"
                                                         LineHeight="1.25"
                                                         TextColor="{DynamicResource Green}">
                                                         <Label.FormattedText>
                                                         <FormattedString>
                                                         <Span Text="+" />
                                                         <Span Text="20.35" />
                                                         </FormattedString>
                                                         </Label.FormattedText>
                                                         </Label>
                                                         
                                                         <Label Grid.Row="1"
                                                         FontFamily="{DynamicResource Medium}"
                                                         FontSize="12"
                                                         HorizontalOptions="Start"
                                                         HorizontalTextAlignment="Center"
                                                         LineHeight="1.25"
                                                         Text="NIFTY 50"
                                                         TextColor="{DynamicResource Gray-700}"
                                                         VerticalTextAlignment="Center" />
                                                         
                                                         <Label Grid.Row="1"
                                                         Grid.Column="1"
                                                         FontFamily="{DynamicResource SemiBold}"
                                                         FontSize="14"
                                                         HorizontalOptions="EndAndExpand"
                                                         LineHeight="1.25"
                                                         Text="6164.34"
                                                         TextColor="{DynamicResource Gray-800}" />-->
                                                </Grid>
                                            </expander:SfExpander.Header>

                                            <expander:SfExpander.Content>
                                                <StackLayout BackgroundColor="{StaticResource GrayShadowColor}" Spacing="8">
                                                    <BoxView HeightRequest="1" Color="{DynamicResource Gray-200}" />

                                                    <Grid>
                                                        <chart:SfChart Margin="8"
                                                                       BackgroundColor="Transparent"
                                                                       HeightRequest="300"
                                                                       HorizontalOptions="FillAndExpand"
                                                                       VerticalOptions="FillAndExpand">

                                                            <chart:SfChart.Title>
                                                                <chart:ChartTitle Text="{Binding Holder.ChartTitle}" />
                                                            </chart:SfChart.Title>

                                                            <chart:SfChart.ChartBehaviors>
                                                                <chart:ChartTooltipBehavior BackgroundColor="#404041" />
                                                            </chart:SfChart.ChartBehaviors>

                                                            <!--X AXIS DISPLAY-->
                                                            <chart:SfChart.PrimaryAxis>
                                                                <chart:CategoryAxis EdgeLabelsDrawingMode="Shift" ShowMajorGridLines="True">
                                                                </chart:CategoryAxis>
                                                            </chart:SfChart.PrimaryAxis>

                                                            <!--Y AXIS DISPLAY-->
                                                            <chart:SfChart.SecondaryAxis>
                                                                <chart:NumericalAxis IsVisible="True"
                                                                                     EdgeLabelsDrawingMode="Shift"
                                                                                     ShowMajorGridLines="True"
                                                                                     ShowMinorGridLines="True"
                                                                                     Interval="1">
                                                                    <chart:NumericalAxis.MajorTickStyle>
                                                                        <chart:ChartAxisTickStyle TickSize="8" />
                                                                    </chart:NumericalAxis.MajorTickStyle>
                                                                </chart:NumericalAxis>
                                                            </chart:SfChart.SecondaryAxis>

                                                            <chart:SfChart.Legend>
                                                                <chart:ChartLegend ToggleSeriesVisibility="True" DockPosition="Top" IconWidth="14" IconHeight="14" />
                                                            </chart:SfChart.Legend>

                                                            <chart:SfChart.ColorModel>
                                                                <chart:ChartColorModel Palette="Natural" />
                                                            </chart:SfChart.ColorModel>

                                                            <chart:SfChart.Series>
                                                                <chart:ColumnSeries ItemsSource ="{Binding Holder.BarData}"
                                                                                    XBindingPath="Name"
                                                                                    YBindingPath="Value" 
                                                                                    LegendIcon="SeriesType"
                                                                                    Label="Label"
                                                                                    EnableTooltip="true" 
                                                                                    EnableAnimation="True" 
                                                                                    TooltipTemplate="{StaticResource toolTipTemplate1}"/>
                                                            </chart:SfChart.Series>
                                                        </chart:SfChart>
                                                    </Grid>
                                                </StackLayout>
                                            </expander:SfExpander.Content>
                                        </expander:SfExpander>
                                    </utils:CustomShadowFrame>
                                </StackLayout>
                            </StackLayout>
                        </ScrollView>
                    </Grid>
                </StackLayout>
            </Grid>
        </AbsoluteLayout>
    </ContentPage.Content>
</ContentPage>