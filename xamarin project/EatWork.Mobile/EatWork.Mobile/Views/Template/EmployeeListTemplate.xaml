<?xml version="1.0" encoding="utf-8" ?>
<StackLayout xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://xamarin.com/schemas/2014/forms/design"
             xmlns:converter="clr-namespace:EatWork.Mobile.Utils"
             xmlns:shared="clr-namespace:EatWork.Mobile.Views.Shared"
             xmlns:custom="clr-namespace:ImageCircle.Forms.Plugin.Abstractions;assembly=ImageCircle.Forms.Plugin"
             xmlns:iconize="clr-namespace:Plugin.Iconize;assembly=Plugin.Iconize"
             xmlns:syncfusion="clr-namespace:Syncfusion.ListView.XForms;assembly=Syncfusion.SfListView.XForms"
             xmlns:busyindicator="clr-namespace:Syncfusion.SfBusyIndicator.XForms;assembly=Syncfusion.SfBusyIndicator.XForms"
             xmlns:avatar="clr-namespace:Syncfusion.XForms.AvatarView;assembly=Syncfusion.Core.XForms"
             xmlns:border="clr-namespace:Syncfusion.XForms.Border;assembly=Syncfusion.Core.XForms"
             xmlns:buttons="clr-namespace:Syncfusion.XForms.Buttons;assembly=Syncfusion.Buttons.XForms"
             mc:Ignorable="d"
             x:Class="EatWork.Mobile.Views.Template.EmployeeListTemplate">
    <StackLayout.Resources>
        <ResourceDictionary>
            <Style x:Key="listImageStyle" TargetType="custom:CircleImage">
                <!--<Setter Property="Source" Value="profile.png" />-->
                <Setter Property="BorderColor" Value="White" />
                <Setter Property="BorderThickness" Value="0.5" />
                <Setter Property="Aspect" Value="AspectFill" />
            </Style>

            <Style x:Key="SeparatorStyle" TargetType="BoxView">
                <Setter Property="HeightRequest" Value="1" />
                <Setter Property="BackgroundColor" Value="{DynamicResource Gray-200}" />
            </Style>

            <Style x:Key="ProfileBorderStyle" TargetType="border:SfBorder">
                <Setter Property="HorizontalOptions" Value="Center" />
                <Setter Property="VerticalOptions" Value="Center" />
                <Setter Property="BorderWidth" Value="1" />
                <Setter Property="BorderColor" Value="{DynamicResource Gray-White}" />
            </Style>

            <Style x:Key="btnStyle" TargetType="buttons:SfButton">
                <Setter Property="CornerRadius" Value="3" />
                <Setter Property="BackgroundColor" Value="White" />
                <Setter Property="BorderColor" Value="Black" />
                <Setter Property="BorderWidth" Value="0.5" />
                <Setter Property="WidthRequest" Value="1000" />
                <Setter Property="HeightRequest" Value="45" />
                <Setter Property="VerticalOptions" Value="EndAndExpand" />
            </Style>

            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Shared/ListHeaderPage.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </StackLayout.Resources>

    <StackLayout VerticalOptions="FillAndExpand"
                 HorizontalOptions="FillAndExpand">

        <AbsoluteLayout VerticalOptions="FillAndExpand" HorizontalOptions="FillAndExpand">

            <busyindicator:SfBusyIndicator x:Name="busyindicator"
                                           Style="{StaticResource BusyIndicatorStyle}"
                                           IsBusy="{Binding IsBusy}" />

            <Grid AbsoluteLayout.LayoutFlags="All"
                  AbsoluteLayout.LayoutBounds="0,0,1,1"
                  IsVisible="{Binding IsBusy, Converter={converter:InverseBoolConverter}}"
                  HorizontalOptions="FillAndExpand"
                  VerticalOptions="FillAndExpand">
                <Grid.RowDefinitions>
                    <!--<RowDefinition Height="45" />-->
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <StackLayout Grid.Row="0" Margin="10,10" Spacing="0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="80" />
                        </Grid.ColumnDefinitions>

                        <Label Text="Employees" HorizontalOptions="Start"
                               FontSize="20"
                               FontFamily="{DynamicResource Bold}"
                               TextColor="{DynamicResource Gray-900}"
                               Grid.Column="0" />

                        <buttons:SfButton x:Name="SkipButton"
                                          Grid.Column="1"
                                          BackgroundColor="Transparent"
                                          Command="{Binding CloseModalCommand}"
                                          CornerRadius="20"
                                          FontFamily="{DynamicResource SemiBold}"
                                          HeightRequest="40"
                                          HorizontalOptions="End"
                                          Text="Close"
                                          TextColor="{x:StaticResource HyperLink}"
                                          VerticalOptions="StartAndExpand"
                                          WidthRequest="80" />
                    </Grid>

                    <Grid RowSpacing="0" ColumnSpacing="0" Margin="0,10,0,0">

                        <shared:NoItemsPartialPage DetailsText="No items available to display."
                                                   IsVisible="{Binding ShowList, Converter={converter:InverseBoolConverter }}"
                                                   HorizontalOptions="CenterAndExpand"
                                                   VerticalOptions="CenterAndExpand" />

                        <shared:NoItemsPartialPage DetailsText="Please try again with different keywords/criteria."
                                                   TitleText="No Result Found"
                                                   IsVisible="{Binding NoItems}"
                                                   HorizontalOptions="CenterAndExpand"
                                                   VerticalOptions="CenterAndExpand" />

                        <syncfusion:SfListView x:Name="EmployeeListView"
                                               ItemsSource="{Binding EmployeeList}"
                                               ItemSize="140"
                                               SelectionMode="None"
                                               HeaderTemplate="{StaticResource CatalogDefaultHeaderTemplate}"
                                               IsStickyGroupHeader="False"
                                               LoadMoreOption="AutoOnScroll"
                                               LoadMoreCommand="{Binding LoadItemsCommand}"
                                               LoadMoreCommandParameter="{Binding Source={x:Reference Name=EmployeeListView}}"
                                               HeaderSize="50"
                                               ItemSpacing="0,0,0,1"
                                               IsVisible="{Binding ShowList}"
                                               IsScrollBarVisible="False">
                            <syncfusion:SfListView.ItemTemplate>
                                <DataTemplate>
                                    <ViewCell>
                                        <StackLayout BackgroundColor="{DynamicResource Gray-White}" Spacing="0">
                                            <Grid Margin="0,8,8,8"  ColumnSpacing="0" RowSpacing="0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>

                                                <border:SfBorder  BackgroundColor="{DynamicResource Gray-200}"
                                                                  Style="{StaticResource ProfileBorderStyle}"
                                                                  HorizontalOptions="Start">
                                                    <avatar:SfAvatarView ContentType="{Binding ImageSource,Converter={converter:ImageAvatarConverter}}"
                                                                         AvatarName="{Binding EmployeeName}"
                                                                         AvatarCharacter="Avatar17"
                                                                         BackgroundColor="{StaticResource Gray-200}"
                                                                         ImageSource="{Binding ImageSource}"
                                                                         BorderColor="{StaticResource Gray-White}"
                                                                         InitialsType="DoubleCharacter"
                                                                         FontAttributes="Bold"
                                                                         Grid.Row="0"
                                                                         Grid.Column="0"
                                                                         HeightRequest="85"
                                                                         WidthRequest="85"
                                                                         CornerRadius="10"
                                                                         HorizontalOptions="StartAndExpand"
                                                                         VerticalOptions="StartAndExpand" />
                                                </border:SfBorder>

                                                <StackLayout Grid.Column="1"
                                                             Margin="16,5"
                                                             HorizontalOptions="Start"
                                                             Spacing="2"
                                                             VerticalOptions="FillAndExpand">

                                                    <Label FontFamily="{DynamicResource Medium}"
                                                           FontSize="16"
                                                           LineHeight="{OnPlatform Android=1.5,
                                                           Default=-1}"
                                                           Text="{Binding EmployeeName}"
                                                           LineBreakMode="TailTruncation"
                                                           TextColor="{DynamicResource Gray-800}" />

                                                    <Label FontFamily="{DynamicResource Medium}"
                                                           FontSize="{StaticResource Smaller}"
                                                           LineHeight="{OnPlatform Android=1.25,
                                                           Default=-1}"
                                                           Text="{Binding EmployeeNo}"
                                                           TextColor="{DynamicResource Gray-700}" />

                                                    <Label FontFamily="{DynamicResource Medium}"
                                                           FontSize="{StaticResource Smaller}"
                                                           LineHeight="{OnPlatform Android=1.25,
                                                           Default=-1}"
                                                           Text="{Binding Position}"
                                                           LineBreakMode="TailTruncation"
                                                           TextColor="{DynamicResource Gray-700}" />

                                                    <Label FontFamily="{DynamicResource Medium}"
                                                           FontSize="{StaticResource Smaller}"
                                                           LineHeight="{OnPlatform Android=1.25,
                                                           Default=-1}"
                                                           Text="{Binding Department}"
                                                           LineBreakMode="TailTruncation"
                                                           TextColor="{DynamicResource Gray-700}" />
                                                </StackLayout>

                                                <iconize:IconButton Text="{StaticResource AddIcon}"
                                                                    Margin="0,0"
                                                                    WidthRequest="50"
                                                                    HeightRequest="50"
                                                                    HorizontalOptions="Center"
                                                                    Grid.Column="2"
                                                                    Opacity="0.60"
                                                                    VerticalOptions="Center"
                                                                    TextColor="{DynamicResource Gray-600}"
                                                                    BackgroundColor="{DynamicResource Transparent}"
                                                                    Command="{Binding Path=BindingContext.SelectedEmployeeCommand, Source={x:Reference EmployeeListView}}"
                                                                    CommandParameter="{Binding .}"
                                                                    FontSize="25"
                                                                    x:Name="SelectButton" />
                                            </Grid>

                                            <!--  Separator -->
                                            <BoxView Style="{StaticResource SeparatorStyle}" />
                                        </StackLayout>
                                    </ViewCell>
                                </DataTemplate>
                            </syncfusion:SfListView.ItemTemplate>
                        </syncfusion:SfListView>
                    </Grid>
                </StackLayout>
            </Grid>
        </AbsoluteLayout>
    </StackLayout>
</StackLayout>