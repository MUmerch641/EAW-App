<?xml version="1.0" encoding="utf-8" ?>
<StackLayout x:Class="EatWork.Mobile.Views.Template.ObjectiveListTemplate"
             xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:border="clr-namespace:Syncfusion.XForms.Border;assembly=Syncfusion.Core.XForms"
             xmlns:effects="clr-namespace:Syncfusion.XForms.EffectsView;assembly=Syncfusion.Core.XForms"
             xmlns:expander="clr-namespace:Syncfusion.XForms.Expander;assembly=Syncfusion.Expander.XForms"
             xmlns:iconize="clr-namespace:Plugin.Iconize;assembly=Plugin.Iconize"
             xmlns:utils="clr-namespace:EatWork.Mobile.Utils">
    <StackLayout.Resources>
        <ResourceDictionary>

            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Styles.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <Style x:Key="HeaderStyle"
                   BasedOn="{StaticResource PriceLabelStyle}"
                   TargetType="Label">
                <Setter Property="FontSize" Value="{DynamicResource Small}" />
                <Setter Property="FontFamily" Value="{DynamicResource SemiBold}" />
                <Setter Property="LineHeight" Value="{OnPlatform Android=1.25, Default=-1}" />
                <Setter Property="TextColor" Value="{DynamicResource Gray-White}" />
                <Setter Property="Margin" Value="0,0" />
            </Style>
        </ResourceDictionary>
    </StackLayout.Resources>

    <utils:CustomShadowFrame Margin="0,0,0,4"
                             Padding="0,0"
                             BorderColor="Transparent"
                             CornerRadius="0"
                             HorizontalOptions="FillAndExpand"
                             Style="{DynamicResource CustomFrameStyle}"
                             VerticalOptions="FillAndExpand">
        <utils:CustomShadowFrame.Content>

            <expander:SfExpander HeaderBackgroundColor="{DynamicResource PrimaryColor}"
                                 HeaderIconPosition="End"
                                 IconColor="{DynamicResource Gray-White}"
                                 IsExpanded="True">
                <expander:SfExpander.Header>
                    <StackLayout Padding="10,12">
                        <!--  PARENT OBJECTIVE  -->
                        <Label LineBreakMode="TailTruncation"
                               Style="{StaticResource HeaderStyle}">
                            <Label.FormattedText>
                                <FormattedString>
                                    <Span FontFamily="{DynamicResource FontAwesomeSolid}"
                                          FontSize="15"
                                          Text="{DynamicResource StringFlagIcon}" />
                                    <Span Text=" " />
                                    <Span Text="{Binding Header}" />
                                </FormattedString>
                            </Label.FormattedText>
                        </Label>
                    </StackLayout>
                </expander:SfExpander.Header>

                <expander:SfExpander.Content>
                    <StackLayout x:Name="DetailsList"
                                 Padding="0,0,0,0"
                                 BindableLayout.ItemsSource="{Binding ObjectiveDetailHeaderDto}"
                                 Spacing="1">
                        <BindableLayout.ItemTemplate>
                            <DataTemplate>

                                <expander:SfExpander HeaderBackgroundColor="{DynamicResource GrayShadowBackgroundColor}"
                                                     HeaderIconPosition="End"
                                                     IconColor="{DynamicResource Gray-900}"
                                                     IsExpanded="True">
                                    <expander:SfExpander.Header>
                                        <StackLayout Padding="0,12">
                                            <!--  GOAL NAME  -->
                                            <Label Margin="0,0"
                                                   Padding="10,0"
                                                   FontFamily="{DynamicResource SemiBold}"
                                                   FontSize="{DynamicResource Smaller}"
                                                   HorizontalOptions="StartAndExpand"
                                                   HorizontalTextAlignment="Start"
                                                   IsVisible="{Binding ObjectiveHeader, Converter={utils:EmptyToBoolConverter}}"
                                                   LineBreakMode="TailTruncation"
                                                   LineHeight="{OnPlatform Default=-1,
                                                                           Android=1.5}"
                                                   MaxLines="3"
                                                   Style="{DynamicResource DescriptionLabelStyle}"
                                                   Text="{Binding ObjectiveHeader}"
                                                   VerticalOptions="End" />

                                            <!--  GOAL NAME  -->
                                            <Label Margin="0,0"
                                                   Padding="10,0"
                                                   FontFamily="{DynamicResource SemiBold}"
                                                   FontSize="{DynamicResource Smaller}"
                                                   HorizontalOptions="StartAndExpand"
                                                   HorizontalTextAlignment="Start"
                                                   IsVisible="{Binding ObjectiveHeader, Converter={utils:EmptyToInverseBoolConverter}}"
                                                   LineBreakMode="TailTruncation"
                                                   LineHeight="{OnPlatform Default=-1,
                                                                           Android=1.5}"
                                                   MaxLines="3"
                                                   Style="{DynamicResource DescriptionLabelStyle}"
                                                   Text=" - "
                                                   VerticalOptions="End" />
                                        </StackLayout>
                                    </expander:SfExpander.Header>

                                    <expander:SfExpander.Content>
                                        <StackLayout x:Name="DetailsList1"
                                                     Padding="0,0,0,0"
                                                     BindableLayout.ItemsSource="{Binding ObjectiveDetailDto}"
                                                     Spacing="1">

                                            <BindableLayout.ItemTemplate>
                                                <DataTemplate>

                                                    <effects:SfEffectsView Style="{DynamicResource RippleEffectStyle}"
                                                                           TouchUpCommand="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.ViewObjectiveItemCommand}"
                                                                           TouchUpCommandParameter="{Binding .}">

                                                        <border:SfBorder BorderColor="Transparent"
                                                                         BorderWidth="0"
                                                                         CornerRadius="4">

                                                            <StackLayout Margin="0,0"
                                                                         Padding="0,5,0,0"
                                                                         Spacing="5"
                                                                         VerticalOptions="Start">
                                                                <!--  OBJECTIVES  -->
                                                                <Grid Margin="0,5,0,0"
                                                                      ColumnSpacing="0"
                                                                      RowSpacing="0"
                                                                      Style="{StaticResource GridMyScheduleDetails}">

                                                                    <Label Grid.ColumnSpan="3"
                                                                           Margin="10,0"
                                                                           FontSize="{DynamicResource Smaller}"
                                                                           HorizontalOptions="StartAndExpand"
                                                                           HorizontalTextAlignment="Start"
                                                                           LineBreakMode="TailTruncation"
                                                                           LineHeight="{OnPlatform Default=-1,
                                                                                                   Android=1.5}"
                                                                           MaxLines="5"
                                                                           Style="{DynamicResource DescriptionLabelStyle}"
                                                                           Text="{Binding Objectives}"
                                                                           VerticalOptions="End" />
                                                                </Grid>

                                                                <!--  KPI  -->
                                                                <Grid Margin="0,5,0,0"
                                                                      ColumnDefinitions="40*,60*"
                                                                      ColumnSpacing="0"
                                                                      RowSpacing="0"
                                                                      Style="{StaticResource GridMyScheduleDetails}">

                                                                    <iconize:IconLabel Grid.Column="0"
                                                                                       Margin="10,0,0,0"
                                                                                       FontFamily="{StaticResource FontAwesomeSolid}"
                                                                                       HorizontalOptions="Start"
                                                                                       Style="{DynamicResource IconLabelStyle}"
                                                                                       Text="{DynamicResource KPIIconString}"
                                                                                       TextColor="{DynamicResource PrimaryColor}"
                                                                                       VerticalOptions="Start" />

                                                                    <Label Grid.Column="1"
                                                                           FontFamily="{DynamicResource Medium}"
                                                                           Style="{StaticResource LabelStyleMySchedule}"
                                                                           Text="{Binding KPIName}" />
                                                                </Grid>

                                                                <Grid Margin="0,5,0,0"
                                                                      ColumnDefinitions="40*,60*"
                                                                      ColumnSpacing="0"
                                                                      RowSpacing="0"
                                                                      Style="{StaticResource GridMyScheduleDetails}">

                                                                    <iconize:IconLabel Grid.Column="0"
                                                                                       Margin="10,0,0,0"
                                                                                       FontFamily="{StaticResource FontAwesomeSolid}"
                                                                                       HorizontalOptions="Start"
                                                                                       Style="{DynamicResource IconLabelStyle}"
                                                                                       Text="{DynamicResource MeasureIconString}"
                                                                                       TextColor="{DynamicResource PrimaryColor}"
                                                                                       VerticalOptions="Start" />

                                                                    <Label Grid.Column="1"
                                                                           FontFamily="{DynamicResource Medium}"
                                                                           Style="{StaticResource LabelStyleMySchedule}"
                                                                           Text="{Binding MeasureName}" />
                                                                </Grid>

                                                                <!--  TARGET GOAL  -->
                                                                <Grid Margin="0,5,0,0"
                                                                      ColumnDefinitions="40*,60*"
                                                                      ColumnSpacing="0"
                                                                      RowSpacing="0"
                                                                      Style="{StaticResource GridMyScheduleDetails}">

                                                                    <iconize:IconLabel Grid.Column="0"
                                                                                       Margin="10,0,0,0"
                                                                                       FontFamily="{StaticResource FontAwesomeSolid}"
                                                                                       HorizontalOptions="Start"
                                                                                       Style="{DynamicResource IconLabelStyle}"
                                                                                       Text="{DynamicResource TargetGoalIconString}"
                                                                                       TextColor="{DynamicResource PrimaryColor}"
                                                                                       VerticalOptions="Start" />

                                                                    <Label Grid.Column="1"
                                                                           FontFamily="{DynamicResource Medium}"
                                                                           Style="{StaticResource LabelStyleMySchedule}"
                                                                           Text="{Binding TargetGoalSetup}" />
                                                                </Grid>

                                                                <!--  WEIGHT  -->
                                                                <Grid Margin="0,5,0,0"
                                                                      ColumnDefinitions="40*,60*"
                                                                      ColumnSpacing="0"
                                                                      RowSpacing="0"
                                                                      Style="{StaticResource GridMyScheduleDetails}">

                                                                    <iconize:IconLabel Grid.Column="0"
                                                                                       Margin="10,0,0,0"
                                                                                       FontFamily="{StaticResource FontAwesomeSolid}"
                                                                                       HorizontalOptions="Start"
                                                                                       Style="{DynamicResource IconLabelStyle}"
                                                                                       Text="{DynamicResource WeightIconString}"
                                                                                       TextColor="{DynamicResource PrimaryColor}"
                                                                                       VerticalOptions="Start" />

                                                                    <Label Grid.Column="1"
                                                                           FontFamily="{DynamicResource Medium}"
                                                                           Style="{StaticResource LabelStyleMySchedule}"
                                                                           Text="{Binding Weight}" />
                                                                </Grid>

                                                                <!--  BASELINE  -->
                                                                <Grid Margin="0,5,0,0"
                                                                      ColumnDefinitions="40*,60*"
                                                                      ColumnSpacing="0"
                                                                      RowSpacing="0"
                                                                      Style="{StaticResource GridMyScheduleDetails}">

                                                                    <iconize:IconLabel Grid.Column="0"
                                                                                       Margin="10,0,0,0"
                                                                                       FontFamily="{StaticResource FontAwesomeSolid}"
                                                                                       HorizontalOptions="Start"
                                                                                       Style="{DynamicResource IconLabelStyle}"
                                                                                       Text="{DynamicResource BaselineIconString}"
                                                                                       TextColor="{DynamicResource PrimaryColor}"
                                                                                       VerticalOptions="Start" />

                                                                    <Label Grid.Column="1"
                                                                           FontFamily="{DynamicResource Medium}"
                                                                           Style="{StaticResource LabelStyleMySchedule}"
                                                                           Text="{Binding BaseLine}" />
                                                                </Grid>

                                                                <StackLayout Margin="0,5" />

                                                                <BoxView Margin="0,5,0,5"
                                                                         BackgroundColor="{DynamicResource Gray-500}"
                                                                         IsVisible="{Binding ShowLine}"
                                                                         Style="{DynamicResource SeparatorStyle}" />
                                                            </StackLayout>
                                                        </border:SfBorder>
                                                    </effects:SfEffectsView>
                                                </DataTemplate>
                                            </BindableLayout.ItemTemplate>
                                        </StackLayout>
                                    </expander:SfExpander.Content>
                                </expander:SfExpander>
                            </DataTemplate>
                        </BindableLayout.ItemTemplate>
                    </StackLayout>
                </expander:SfExpander.Content>
            </expander:SfExpander>
        </utils:CustomShadowFrame.Content>
    </utils:CustomShadowFrame>
</StackLayout>